files:
  "/etc/httpd/conf.d/enable_mod_deflate.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      # mod_deflate configuration
      <IfModule mod_expires.c>
      ExpiresActive On
      # Set default expires to 2 days
      ExpiresDefault A172800
      ExpiresByType image/gif A31536000
      ExpiresByType image/jpeg A31536000
      ExpiresByType image/png A31536000
      </IfModule>
      <filesMatch "\.(jpg|jpeg|png|gif)$">
      ExpiresDefault A604800
      Header set Cache-Control "max-age=604800, must-revalidate"
      </filesMatch>
      <IfModule mime_module>
      AddType font/ttf .ttf
      AddType font/eot .eot
      </IfModule>
      <IfModule mod_deflate.c>
      # Restrict compression to these MIME types
      AddOutputFilterByType DEFLATE font/ttf font/eot 
      AddOutputFilterByType DEFLATE text/plain
      AddOutputFilterByType DEFLATE text/html
      AddOutputFilterByType DEFLATE application/xhtml+xml
      AddOutputFilterByType DEFLATE text/xml
      AddOutputFilterByType DEFLATE application/xml
      AddOutputFilterByType DEFLATE application/xml+rss
      AddOutputFilterByType DEFLATE application/x-javascript
      AddOutputFilterByType DEFLATE text/javascript
      AddOutputFilterByType DEFLATE text/css
      #AddOutputFilterByType DEFLATE image/png
      #AddOutputFilterByType DEFLATE image/gif
      #AddOutputFilterByType DEFLATE image/jpeg

      # Level of compression (Highest 9 - Lowest 1)
      DeflateCompressionLevel 9

      # Netscape 4.x has some problems.
      BrowserMatch ^Mozilla/4 gzip-only-text/html

      # Netscape 4.06-4.08 have some more problems
      BrowserMatch ^Mozilla/4\.0[678] no-gzip

      # MSIE masquerades as Netscape, but it is fine
      BrowserMatch \bMSI[E] !no-gzip !gzip-only-text/html

      <IfModule mod_headers.c>
      # Make sure proxies don't deliver the wrong content
      Header append Vary User-Agent env=!dont-vary
      </IfModule>

      </IfModule> 